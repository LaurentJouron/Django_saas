{% extends "admin/change_list.html" %}
{% load i18n static %}

{% block extrastyle %}
    {{ block.super }}
    <script src="https://cdn.tailwindcss.com"></script>
{% endblock %}

{% block content_title %}
    <h1 class="text-2xl font-bold mb-4">{{ title }}</h1>
    
    {% if total_visits %}
    <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-5 mb-5 shadow-lg">
        <h2 class="text-white text-lg font-semibold mb-4">ğŸ“Š Statistiques des visites</h2>
        
        <!-- Statistiques en cartes -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
            <!-- Total -->
            <div class="bg-white/95 rounded-lg p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-indigo-600">{{ total_visits }}</div>
                <div class="text-gray-600 text-sm mt-1">Total des visites</div>
            </div>
            
            <!-- Today -->
            <div class="bg-white/95 rounded-lg p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-green-600">{{ visits_today }}</div>
                <div class="text-gray-600 text-sm mt-1">Aujourd'hui ğŸ“…</div>
            </div>
            
            <!-- This week -->
            <div class="bg-white/95 rounded-lg p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-yellow-500">{{ visits_week }}</div>
                <div class="text-gray-600 text-sm mt-1">Cette semaine ğŸ”¥</div>
            </div>
            
            <!-- Thie month -->
            <div class="bg-white/95 rounded-lg p-4 text-center shadow-md">
                <div class="text-3xl font-bold text-red-500">{{ visits_month }}</div>
                <div class="text-gray-600 text-sm mt-1">Ce mois ğŸ“ˆ</div>
            </div>
        </div>
        
        <!-- Top 5 -->
        {% if top_paths %}
        <div class="bg-white/95 rounded-lg p-4 shadow-md">
            <h3 class="text-gray-800 font-semibold mb-4">ğŸ† Top 5 des pages les plus visitÃ©es</h3>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b-2 border-indigo-600">
                            <th class="py-2 text-left text-indigo-600 text-xs font-semibold w-10">#</th>
                            <th class="py-2 px-3 text-left text-indigo-600 text-xs font-semibold">Chemin</th>
                            <th class="py-2 px-3 text-right text-indigo-600 text-xs font-semibold w-36">Visites</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in top_paths %}
                        <tr class="border-b border-gray-200 hover:bg-gray-50 transition-colors duration-200">
                            <td class="py-3 text-gray-400 font-bold text-sm">
                                {{ forloop.counter }}
                            </td>
                            <td class="py-3 px-3">
                                {% if item.path %}
                                    <code class="text-indigo-600 bg-gray-100 px-2.5 py-1.5 rounded text-xs font-mono inline-block">{{ item.path }}</code>
                                {% else %}
                                    <code class="text-gray-400 bg-gray-100 px-2.5 py-1.5 rounded text-xs font-mono inline-block">/</code>
                                    <span class="text-gray-400 text-xs ml-2">(page d'accueil)</span>
                                {% endif %}
                            </td>
                            <td class="py-3 px-3 text-right whitespace-nowrap">
                                <span class="text-indigo-600 text-xl font-bold">{{ item.count }}</span>
                                <span class="text-gray-400 text-xs ml-1">visite{{ item.count|pluralize }}</span>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="3" class="py-5 text-center text-gray-400">
                                Aucune donnÃ©e disponible
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% else %}
        <div class="bg-white/95 rounded-lg p-4 shadow-md text-center">
            <p class="text-gray-400 mb-0">
                <span class="text-2xl block mb-2">ğŸ“Š</span>
                Aucune visite enregistrÃ©e pour le moment
            </p>
        </div>
        {% endif %}
    </div>
    {% else %}
    <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-8 mb-5 shadow-lg text-center">
        <div class="text-5xl mb-3">ğŸ“Š</div>
        <h2 class="text-white text-xl font-semibold mb-2">Aucune visite enregistrÃ©e</h2>
        <p class="text-white/80 text-sm">Les statistiques apparaÃ®tront dÃ¨s la premiÃ¨re visite</p>
    </div>
    {% endif %}
{% endblock %}